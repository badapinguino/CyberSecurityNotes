# Vulnerability Scanning with Nessus

<figure><img src="../.gitbook/assets/image (1).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../.gitbook/assets/image (1) (1).png" alt=""><figcaption></figcaption></figure>

## Installare Nessus Essentials

Visitare la pagina di tnable per scaricare nessus essentials

<figure><img src="../.gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>

Premere il pulsante download per l'opzione Nessus Essentials.

<figure><img src="../.gitbook/assets/image (3).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../.gitbook/assets/image (4).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../.gitbook/assets/image (5).png" alt=""><figcaption></figcaption></figure>

Scarichiamo la versione per Debian / Kali Linux

<figure><img src="../.gitbook/assets/image (6).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../.gitbook/assets/image (7).png" alt=""><figcaption></figcaption></figure>

```
cd Downloads
chmod + Nessus-10.0.0-debian6_amd64.deb
sudo dpkg -i Nessus-10.0.0-debian6_amd64.deb
// Per avviare:
sudo systemctl start nessusd.service
// visita la pagina https://kali:8834/
```

Per avviare Nessus bisogna avviare lo scanner tramite systemctl start e poi visitare la pagina web di kali.

### Avviare il servizio Nessus

<figure><img src="../.gitbook/assets/image (8).png" alt=""><figcaption></figcaption></figure>

Visitiamo ora la pagina web di Nessus:

<figure><img src="../.gitbook/assets/image (9).png" alt=""><figcaption></figcaption></figure>

Noi facciamo skip perché abbiamo già un codice che ci ha dato prima quando abbiamo scaricato

<figure><img src="../.gitbook/assets/image (11).png" alt=""><figcaption></figcaption></figure>

Dopo aver inserito il codice ci chiede di creare username e password:

<figure><img src="../.gitbook/assets/image (12).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../.gitbook/assets/image (13).png" alt=""><figcaption></figcaption></figure>

Ora scarica e compila i plugin necessari e poi possiamo usarlo.

<figure><img src="../.gitbook/assets/image (14).png" alt=""><figcaption></figcaption></figure>

Una volta installato ci viene presentata questa pagina dove inserire degli IP per fare una discovery scan, ma noi già sappiamo qual è l'IP quindi evitiamo di farlo.

<figure><img src="../.gitbook/assets/image (15).png" alt=""><figcaption></figcaption></figure>

Noi scegliamo di fare una Basic Network Scan che è una full system scan:

<figure><img src="../.gitbook/assets/image (16).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../.gitbook/assets/image (17).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../.gitbook/assets/image (18).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../.gitbook/assets/image (19).png" alt=""><figcaption></figcaption></figure>

Noi useremo lo scan type di default.

<figure><img src="../.gitbook/assets/image (20).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../.gitbook/assets/image (21).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../.gitbook/assets/image (22).png" alt=""><figcaption></figcaption></figure>

Una volta terminate le configurazioni si preme il pulsante Save e verrà mostrato lo scan configurato tra i My Scans:

<figure><img src="../.gitbook/assets/image (23).png" alt=""><figcaption></figcaption></figure>

Per avviare lo scan premere il pulsante play piccolino a destra.

<figure><img src="../.gitbook/assets/image (24).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../.gitbook/assets/image (25).png" alt=""><figcaption></figcaption></figure>

A noi dei risultati interessa particolarmente il tab Vulnerabilities:

<figure><img src="../.gitbook/assets/image (26).png" alt=""><figcaption></figcaption></figure>

Se non si cambia il filtro di default vengono visualizzati i risultati partendo dall'applicazione che ha più vulnerabilità.

<figure><img src="../.gitbook/assets/image (27).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../.gitbook/assets/image (28).png" alt=""><figcaption></figcaption></figure>

Ad esempio impostando il filtro Metasploit Exploit Framework a true troviamo le vulnerabilità che sono exploitabili con Metasploit.

<figure><img src="../.gitbook/assets/image (29).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../.gitbook/assets/image (30).png" alt=""><figcaption></figcaption></figure>

Le informazioni importanti mostrate sono CVE, CVSS, exploits available ed exploitable with dalla colonna di destra.

<figure><img src="../.gitbook/assets/image (31).png" alt=""><figcaption></figcaption></figure>

Altro filtro utile: per severity

<figure><img src="../.gitbook/assets/image (33).png" alt=""><figcaption></figcaption></figure>

### Esportare i risultati dello scan

<figure><img src="../.gitbook/assets/image (32).png" alt=""><figcaption></figcaption></figure>

Esportare i risultati come "Export > Nessus" e importarli nel DB di Metasploit Framework

<figure><img src="../.gitbook/assets/image (34).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../.gitbook/assets/image (35).png" alt=""><figcaption></figcaption></figure>

#### Avviamo MSF Console per importarci i risultati di Nessus

```
msfconsole
workspace -a MS3_Nessus
db_import /home/kali/Downloads/MS3_fkthix.nessus
hosts
services
vulns
```

<figure><img src="../.gitbook/assets/image (36).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../.gitbook/assets/image (37).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../.gitbook/assets/image (38).png" alt=""><figcaption></figcaption></figure>

Se eseguiamo vulns ci mostra tutte le vulnerabilità presenti:

<figure><img src="../.gitbook/assets/image (39).png" alt=""><figcaption></figcaption></figure>

Per limitare i risultati delle vulnerabilità ad un solo servizio, es. SMB, devo specificare la porta:

```
vulns -p 445
```

<figure><img src="../.gitbook/assets/image (40).png" alt=""><figcaption></figcaption></figure>

Per trovare i moduli exploit per una particolare vulnerabilità si può inserire il CVE (o anche solo l'anno) nella ricerca e poi specificare il servizio (es. SMB):

<figure><img src="../.gitbook/assets/image (41).png" alt=""><figcaption></figcaption></figure>

In alcuni casi potremmo non trovare moduli per la vulnerabilità che ci interessa come nel caso qui sotto:

<figure><img src="../.gitbook/assets/image (42).png" alt=""><figcaption></figcaption></figure>

Può essere utile cercare anche usando il Microsoft Vulnerability Identifier e non solo il CVE:

<figure><img src="../.gitbook/assets/image (43).png" alt=""><figcaption></figcaption></figure>

Proviamo a cercare un exploit per ManageEngine:

<figure><img src="../.gitbook/assets/image (44).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../.gitbook/assets/image (45).png" alt=""><figcaption></figcaption></figure>

Ed in questo caso è proprio il primo che ci servirebbe.

<figure><img src="../.gitbook/assets/image (46).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../.gitbook/assets/image (47).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>



Chiaro che però è più semplice usare l'interfaccia di Nessus, e se necessitiamo di trovare le vulnerabilità che hanno degli exploit su nessus possiamo sempre usare il filtro imparato prima:

<figure><img src="../.gitbook/assets/image (49).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../.gitbook/assets/image (50).png" alt=""><figcaption></figcaption></figure>

E poi possiamo ripassare su MSF console e cercare ad esempio il secondo qui sopra:

<figure><img src="../.gitbook/assets/image (51).png" alt=""><figcaption></figcaption></figure>

Oppure delle volte viene mostrato il nome del modulo MSF direttamente nella colonna destra dentro la vulnerabilità su Nessus:

<figure><img src="../.gitbook/assets/image (52).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../.gitbook/assets/image (53).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../.gitbook/assets/image (54).png" alt=""><figcaption></figcaption></figure>
