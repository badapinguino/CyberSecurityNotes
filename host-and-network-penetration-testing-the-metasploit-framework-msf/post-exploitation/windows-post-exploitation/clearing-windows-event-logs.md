# Clearing Windows Event Logs

<figure><img src="../../../.gitbook/assets/image (13).png" alt=""><figcaption></figcaption></figure>

è fondamentale ripulire le tracce sul Windows Log prima di terminare il nostro pentest.

## Accesso alla macchina target

Facciamo come prima exploitando BadBlue e otteniamo accesso al target con meterpreter:

<figure><img src="../../../.gitbook/assets/image (14).png" alt=""><figcaption></figcaption></figure>

## Dettagli funzionamento log di Windows

{% hint style="warning" %}
è necessario avere permessi amministrativi per poter pulire il Windows Event Log!
{% endhint %}

Sulla macchina target possiamo aprire l'Event Viewer di Windows e vedere la suddivisione dei log nelle categorie elencate sopra (application, system, security):

<figure><img src="../../../.gitbook/assets/image (15).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (16).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (17).png" alt=""><figcaption></figcaption></figure>

Ora proviamo a fare qualche azione sul target dalla macchina Kali come ad esempio cambiare la password di un utente per vedere se sul registro Windows viene loggata:

<figure><img src="../../../.gitbook/assets/image (18).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (19).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (20).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (21).png" alt=""><figcaption></figcaption></figure>

Possiamo notare nei dettagli dell'evento il Password Last Set che risale al momento stesso dell'evento.

## Pulire le tracce dell'Event Log Windows

{% hint style="warning" %}
è necessario avere permessi amministrativi per poter pulire il Windows Event Log!
{% endhint %}

```
//Dentro meterpreter
clearev
//è importante anche eliminare (con il comando rm) eventuali file malevoli caricati sul sistema
```

<figure><img src="../../../.gitbook/assets/image (22).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (23).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (24).png" alt=""><figcaption></figcaption></figure>

Ed effettivamente vediamo che l'Event Log è stato ripulito, ed è l'unico log presente.

<figure><img src="../../../.gitbook/assets/image (25).png" alt=""><figcaption></figcaption></figure>
