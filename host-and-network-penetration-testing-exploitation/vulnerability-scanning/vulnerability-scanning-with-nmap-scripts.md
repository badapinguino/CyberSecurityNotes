# Vulnerability Scanning With Nmap Scripts

<figure><img src="../../.gitbook/assets/image (7).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (8).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (9).png" alt=""><figcaption></figcaption></figure>



## Identificare servizi e OS

```
nmap -sV -O 192.152.25.3
ls -al /usr/share/nmap/scripts/ | grep http //perché abbiamo trovato una porta 80 con Apache
nmap -sV --script=http-enum -p 80 192.152.25.3
```

<figure><img src="../../.gitbook/assets/image (10).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (11).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (12).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (13).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (15).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (16).png" alt=""><figcaption></figcaption></figure>

## Nmap script

Si può guardare anche il contenuto degli nmap script, sono scritti nel linguaggio Lua.

<figure><img src="../../.gitbook/assets/image (17).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (18).png" alt=""><figcaption></figcaption></figure>

### Script che fanno detect delle vulnerabilità

```
ls -al /usr/share/nmap/scripts/ | grep vuln
//Oppure ad esempio vediamo se il target webserver ha shellshock
ls -al /usr/share/nmap/scripts/ | grep shellshock
nmap -sV -p 80 --script=http-shellshock 192.152.25.3
// in questo caso non ci da informazioni aggiuntive perché mancano degli argomenti richiesti dallo script

```

<figure><img src="../../.gitbook/assets/image (19).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (20).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (21).png" alt=""><figcaption></figcaption></figure>

### Identificare la vulnerabilità shellshock (via CGI script)

```
nmap -sV -p 80 --script=http-shellshock --script-args "http-shellshock.uri=/gettime.cgi" 192.152.25.3
```

<figure><img src="../../.gitbook/assets/image (23).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (22).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (24).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (25).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (26).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (27).png" alt=""><figcaption></figcaption></figure>

***

{% hint style="success" %}
Per trovare se il servizio del target è vulnerabile a delle vulnerabilità conosciute, basta utilizzare il comando ls listando gli nmap script e poi facendo grep per il protocollo/servizio target in esecuzione. Ad esempio per FTP:

![](<../../.gitbook/assets/image (28).png>)
{% endhint %}
