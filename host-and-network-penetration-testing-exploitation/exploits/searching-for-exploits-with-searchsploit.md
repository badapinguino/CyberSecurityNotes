# Searching For Exploits With SearchSploit

<figure><img src="../../.gitbook/assets/image (31) (1).png" alt=""><figcaption></figcaption></figure>

```
sudo apt-get update && sudo apt-get install exploitdb -y
ls -al /usr/share/exploitdb #dove sono contenuti i file con exploits e shellcodes
searchsploit
searchsploit -u ##Fa l'update del exploit DB salvato
```

<figure><img src="../../.gitbook/assets/image (32) (1).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (33) (1).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (34).png" alt=""><figcaption></figcaption></figure>

è possibile cercare nelle sottocartelle filtrando per Type, Platform, ecc... come era possibile dalla GUI del sito:

<figure><img src="../../.gitbook/assets/image (35).png" alt=""><figcaption></figcaption></figure>

Gli exploit sono tutti listati con ExploitDB-ID come nome file:

<figure><img src="../../.gitbook/assets/image (36).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (37).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (38).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (39).png" alt=""><figcaption></figcaption></figure>

## Come usare searchsploit

```
searchsploit vsftpd 2.3.4
# copiamo un exploit che abbiamo ottenuto come risultato dalla ricerca sopra nella cartella locale
pwd
searchsploit -m 49757
ls -al #ed ora ho l'exploit copiato nella cartella locale
```

<figure><img src="../../.gitbook/assets/image (40).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (41).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (42).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (43).png" alt=""><figcaption></figcaption></figure>

### Searchsploit search term

```
searchsploit -c OpenSSH #-c per Case Sensitive
searchsploit -t vsftpd #-t dice che la parola specificata deve essere presente nel titolo
searchsploit -t Buffer Overflow ##cerco un tipo di vulnerabilità nel titolo
searchsploit ##mostra l'help
searchsploit -e "Windows XP"  ##cerca le parole esatte -e sta per exact
searchsploit -e "Windows XP" | grep -e "Microsoft"  #per filtrare i risultati della ricerca per la parola Microsoft
searchsploit -e "OpenSSH 7.2p2"
```

<figure><img src="../../.gitbook/assets/image.png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (1).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (3).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (5).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (6).png" alt=""><figcaption></figcaption></figure>

### Search filter

```bash
searchsploit remote windows smb  ##Cercare tutti i remote exploits per Windows con target il servizio smb
searchsploit remote windows buffer ##per cercare buffer overflow per Windows eseguibili da remoto
searchsploit remote linux ssh
searchsploit remote webapps wordpress  ##remote wordpress exploits per un webserver
searchsploit remote webapps drupal
searchsploit local windows ##cerchiamo gli exploit in locale per sistemi windows
searchsploit local windows | grep "Microsoft" ##escludiamo tutti gli exploit che riguardano programmi vari per Windows, e ci concentriamo su quelli per Microsoft Windows.
```

<figure><img src="../../.gitbook/assets/image (7).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (8).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (9).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (10).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (11).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (12).png" alt=""><figcaption></figcaption></figure>

Ma questa ricerca sopra contiene anche molti risultati che non ci interessano per vari programmi e servizi Windows. Quindi possiamo filtrare per Microsoft con grep:

<figure><img src="../../.gitbook/assets/image (13).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (14).png" alt=""><figcaption></figcaption></figure>

### Ottenere i link agli exploit online (per approfondire funzionamento)

```bash
searchsploit remote windows smb -w | grep -e "EternalBlue" #-w per avere il link di exploit-db online invece del path in locale

```

<figure><img src="../../.gitbook/assets/image (15).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (16).png" alt=""><figcaption></figcaption></figure>

### Copiare i file degli exploit di searchsploit

Il percorso sotto il quale trovare il path che ci restituisce come risultato searchsploit è **/usr/share/exploitdb/exploits/**

```
sudo cp /usr/share/exploitdb/exploits/windows/remote/42031.py .
ls
```

<figure><img src="../../.gitbook/assets/image (17).png" alt=""><figcaption></figcaption></figure>
