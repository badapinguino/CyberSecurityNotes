# The Metasploit Framework (MSF)

<figure><img src="../../.gitbook/assets/image (1310).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (1311).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (1312).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (1313).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (1314).png" alt=""><figcaption></figcaption></figure>

***

## Lab: Esempio di utilizzo di Metasploit (MSF) per pentest

<figure><img src="../../.gitbook/assets/image (1315).png" alt=""><figcaption></figcaption></figure>

Abbiamo identificato vari servizi, tra cui un webserver, visitiamo la pagina.

<figure><img src="../../.gitbook/assets/image (1316).png" alt=""><figcaption></figcaption></figure>

Vediamo che esegue Process Maker by Colosa Inc, ma non vediamo la versione, proviamo a cercarla nel codice della pagina:

<figure><img src="../../.gitbook/assets/image (1317).png" alt=""><figcaption></figcaption></figure>

Ma non troviamo niente, allora dovremmo cercare online delle credenziali di default per ProcessMaker.

<figure><img src="../../.gitbook/assets/image (1318).png" alt=""><figcaption></figcaption></figure>

Testiamo il login con admin admin:

<figure><img src="../../.gitbook/assets/image (1319).png" alt=""><figcaption></figcaption></figure>

Cerchiamo la versione di Process Maker:

<figure><img src="../../.gitbook/assets/image (1320).png" alt=""><figcaption></figcaption></figure>

Trovata, è 2.5.0. Tra l'altro usa un DB che è lo stesso che avevamo trovato con la nmap scan.

Ora che abbiamo la versione cerchiamo se è vulnerabile ed esiste qualche exploit:

<figure><img src="../../.gitbook/assets/image (1322).png" alt=""><figcaption></figcaption></figure>

Troviamo 3 exploit, e guardiamo l'ultimo che ci consente di fare PHP Code Execution ed è su Metasploit.

Per capire cosa fa l'exploit lo copiamo in una nostra cartella e lo apriamo con vim:

<figure><img src="../../.gitbook/assets/image (1323).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (1324).png" alt=""><figcaption></figcaption></figure>

Leggiamo che nella Description viene detta la vulnerabilità che viene sfruttata con questo exploit e che la vulnerabilità è presente nelle versioni 2.x, quindi noi avendo come target una 2.5 dovrebbe essere vulnerabile.

Rimuoviamo l'exploit copiato in locale perché tanto lo eseguiremo via Metasploit Framework:

<figure><img src="../../.gitbook/assets/image (1325).png" alt=""><figcaption></figcaption></figure>

Avviamo MSF Console e il suo postgresql database e creiamo un workspace ProcessMaker:

<figure><img src="../../.gitbook/assets/image (1326).png" alt=""><figcaption></figcaption></figure>

Cerchiamo l'exploit:

<figure><img src="../../.gitbook/assets/image (1327).png" alt=""><figcaption></figcaption></figure>

Utilizziamo l'exploit che è il primo:

<figure><img src="../../.gitbook/assets/image (1328).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (1329).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (1330).png" alt=""><figcaption></figcaption></figure>

Abbiamo accesso al sistema avendo sfruttato la vulnerabilità con l'esecuzione dell'exploit.

Ora possiamo cercare la flag:

<figure><img src="../../.gitbook/assets/image (1331).png" alt=""><figcaption></figcaption></figure>

E da questo punto in poi fare un po' di local enumeration e le varie attività di post-exploitation.
